
@{
    ViewBag.Title = "CrearCuenta";
}
@{
    Layout = null;
}

<!DOCTYPE html>
<link href="~/Sidebar/styles.css" rel="stylesheet" />

<style>
    .box {
        position: relative;
        top: 0;
        opacity: 1;
        float: left;
        padding: 60px 50px 40px 50px;
        width: 100%;
        background: #fff;
        border-radius: 10px;
        transform: scale(1);
        -webkit-transform: scale(1);
        -ms-transform: scale(1);
        z-index: 5;
    }

        .box.back {
            transform: scale(.95);
            -webkit-transform: scale(.95);
            -ms-transform: scale(.95);
            top: -20px;
            opacity: .8;
            z-index: -1;
        }

        .box:before {
            content: "";
            width: 100%;
            height: 30px;
            border-radius: 10px;
            position: absolute;
            top: -10px;
            background: rgba(255, 255, 255, .6);
            left: 0;
            transform: scale(.95);
            -webkit-transform: scale(.95);
            -ms-transform: scale(.95);
            z-index: -1;
        }

    .overbox .title {
        color: #fff;
    }

        .overbox .title:before {
            background: #fff;
        }

    .title {
        width: 100%;
        float: left;
        line-height: 46px;
        font-size: 34px;
        font-weight: 700;
        letter-spacing: 2px;
        color: #5cb874;
        position: relative;
    }

        .title:before {
            content: "";
            width: 5px;
            height: 100%;
            position: absolute;
            top: 0;
            left: -50px;
            background: #5cb874;
        }

    .input,
    .input label,
    .input input,
    .input .spin,
    .button,
    .button button .button.login button i.fa,
    .material-button .shape:before,
    .material-button .shape:after,
    .button.login button {
        transition: 300ms cubic-bezier(.4, 0, .2, 1);
        -webkit-transition: 300ms cubic-bezier(.4, 0, .2, 1);
        -ms-transition: 300ms cubic-bezier(.4, 0, .2, 1);
    }

    .material-button,
    .alt-2,
    .material-button .shape,
    .alt-2 .shape,
    .box {
        transition: 400ms cubic-bezier(.4, 0, .2, 1);
        -webkit-transition: 400ms cubic-bezier(.4, 0, .2, 1);
        -ms-transition: 400ms cubic-bezier(.4, 0, .2, 1);
    }

    .input,
    .input label,
    .input input,
    .input .spin,
    .button,
    .button button {
        width: 100%;
        float: left;
    }

    .input,
    .button {
        margin-top: 30px;
        height: 70px;
    }

        .input,
        .input input,
        .button,
        .button button {
            position: relative;
        }

            .input input {
                height: 60px;
                top: 10px;
                border: none;
                background: transparent;
            }

            .input input,
            .input label,
            .button button {
                font-family: 'Raleway', sans-serif;
                font-size: 24px;
                color: rgba(0, 0, 0, 0.8);
                font-weight: 300;
            }

            .input:before,
            .input .spin {
                width: 100%;
                height: 1px;
                position: absolute;
                bottom: 0;
                left: 0;
            }

            .input:before {
                content: "";
                background: rgba(0, 0, 0, 0.1);
                z-index: 3;
            }

            .input .spin {
                background: #5cb874;
                z-index: 4;
                width: 0;
            }

    .overbox .input .spin {
        background: rgba(255, 255, 255, 1);
    }

    .overbox .input:before {
        background: rgba(255, 255, 255, 0.5);
    }

    .input label {
        position: absolute;
        top: 10px;
        left: 0;
        z-index: 2;
        cursor: pointer;
        line-height: 60px;
    }

    .button.login {
        width: 60%;
        left: 20%;
    }

        .button.login button,
        .button button {
            width: 100%;
            line-height: 64px;
            left: 0%;
            background-color: transparent;
            border: 3px solid rgba(0, 0, 0, 0.1);
            font-weight: 900;
            font-size: 18px;
            color: rgba(0, 0, 0, 0.2);
        }

    .button.login {
        margin-top: 30px;
    }

    .button {
        margin-top: 20px;
    }

        .button button {
            background-color: #fff;
            color: #5cb874;
            border: none;
        }

        .button.login button.active {
            border: 3px solid transparent;
            color: #fff !important;
        }

            .button.login button.active span {
                opacity: 0;
                transform: scale(0);
                -webkit-transform: scale(0);
                -ms-transform: scale(0);
            }

            .button.login button.active i.fa {
                opacity: 1;
                transform: scale(1) rotate(-0deg);
                -webkit-transform: scale(1) rotate(-0deg);
                -ms-transform: scale(1) rotate(-0deg);
            }

        .button.login button i.fa {
            width: 100%;
            height: 100%;
            position: absolute;
            top: 0;
            left: 0;
            line-height: 60px;
            transform: scale(0) rotate(-45deg);
            -webkit-transform: scale(0) rotate(-45deg);
            -ms-transform: scale(0) rotate(-45deg);
        }

        .button.login button:hover {
            color: #5cb874;
            border-color: #5cb874;
        }

    .button {
        margin: 40px 0;
        overflow: hidden;
        z-index: 2;
    }

        .button button {
            cursor: pointer;
            position: relative;
            z-index: 2;
        }

    .pass-forgot {
        width: 100%;
        float: left;
        text-align: center;
        color: rgba(0, 0, 0, 0.4);
        font-size: 18px;
    }

    .click-efect {
        position: absolute;
        top: 0;
        left: 0;
        background: #5cb874;
        border-radius: 50%;
    }

    .overbox {
        width: 100%;
        height: 100%;
        position: absolute;
        top: 0;
        left: 0;
        overflow: inherit;
        border-radius: 10px;
        padding: 60px 50px 40px 50px;
    }

        .overbox .title,
        .overbox .button,
        .overbox .input {
            z-index: 111;
            position: relative;
            color: #5cb874 !important;
            display: none;
        }

        .overbox .title {
            width: 80%;
        }

        .overbox .input {
            margin-top: 20px;
        }

            .overbox .input input,
            .overbox .input label {
                color: #fff;
            }

        .overbox .material-button,
        .overbox .material-button .shape,
        .overbox .alt-2,
        .overbox .alt-2 .shape {
            display: block;
        }

    .material-button,
    .alt-2 {
        width: 140px;
        height: 140px;
        border-radius: 50%;
        background: #5cb874;
        position: absolute;
        top: 40px;
        right: -70px;
        cursor: pointer;
        z-index: 100;
        transform: translate(0%, 0%);
        -webkit-transform: translate(0%, 0%);
        -ms-transform: translate(0%, 0%);
    }

        .material-button .shape,
        .alt-2 .shape {
            position: absolute;
            top: 0;
            right: 0;
            width: 100%;
            height: 100%;
        }

            .material-button .shape:before,
            .alt-2 .shape:before,
            .material-button .shape:after,
            .alt-2 .shape:after {
                content: "";
                background: #fff;
                position: absolute;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%) rotate(360deg);
                -webkit-transform: translate(-50%, -50%) rotate(360deg);
                -ms-transform: translate(-50%, -50%) rotate(360deg);
            }

            .material-button .shape:before,
            .alt-2 .shape:before {
                width: 25px;
                height: 4px;
            }

            .material-button .shape:after,
            .alt-2 .shape:after {
                height: 25px;
                width: 4px;
            }

        .material-button.active,
        .alt-2.active {
            top: 50%;
            right: 50%;
            transform: translate(50%, -50%) rotate(0deg);
            -webkit-transform: translate(50%, -50%) rotate(0deg);
            -ms-transform: translate(50%, -50%) rotate(0deg);
        }

    body {
        background-color: #cdcdcd;
        background-position: center;
        background-size: cover;
        background-repeat: no-repeat;
        min-height: 100vh;
        font-family: 'Raleway', sans-serif;
    }

    body,
    html {
        overflow: hidden;
    }

    .materialContainer {
        width: 100%;
        max-width: 460px;
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        -webkit-transform: translate(-50%, -50%);
        -ms-transform: translate(-50%, -50%);
    }

    *,
    *:after,
    *::before {
        -webkit-box-sizing: border-box;
        -moz-box-sizing: border-box;
        box-sizing: border-box;
        margin: 0;
        padding: 0;
        text-decoration: none;
        list-style-type: none;
        outline: none;
    }
</style>
<head>

    <meta name="viewport" content="width=device-width" />
    <meta charset="UTF-8">
    <title>CrearCuenta</title>
    

</head>
<body>
    <img src="~/assets/img/turismo-mendoza.jpg" class="img-fluid" alt="" style="height:120vh;">
    <div class="materialContainer">

        <div class="box">
            <h1 class="center"><img src="~/assets/img/arrendasys-sinfondo.png" class="img-fluid" alt="" style="height:10vh;margin-left:80px"></h1> <!--VERIFICAR-->
            <div class="title">Crear Cuenta</div>

            <div class="input">
                
                <label for="email">E-mail</label>
                <input type="email" name="email" id="email">
                <span class="spin"></span>
            </div>
            <div id="xmail"><h6>Ingrese un email válido</h6></div>
            <div class="input" id="divpass">
                <label for="pass">Contraseña</label>
                <input type="password" name="pass" id="pass">
                <span class="spin"></span>
                <br />
            </div>
            <div id="xpass"><h6>La contraseña no cumple los requisitos. Debe contener mínimo 8 caractéres incluyendo: Mayúscula, minúscula, número y caracter especial</h6></div>
            <div class="input" id="divpass1">
                <label for="pass1">Confirmar Contraseña</label>
                <input type="password" name="pass1" id="pass1">
                <span class="spin"></span>
            </div>
            <span id="igualdad">Debe confirmar la contraseña</span>
           
            <div class="input" id="confirm">
                <label for="codigo">Codigo confirmacion</label>
                <input type="number" name="codigo" id="codigo">
                <span class="spin"></span>
            </div>


            <div class="button login">
                <button id="crearCuenta"><span>Crear Cuenta</span> <i class="fa fa-check"></i></button>
            </div>
            <div class="button login" id="confirmar">
                <button id="confirmar"><span>Confirmar</span> <i class="fa fa-check"></i></button>
            </div>
            <div class="button login">
                <button id="Cancelar" onclick="atras()"><span>Cancelar</span> <i class="fa fa-check"></i></button>
            </div>

        </div>

    </div>
    <script src="~/Scripts/bootstrap.bundle.min.js"></script>
    <script src="~/Sidebar/scripts.js"></script>
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" />
    <link href="//fonts.googleapis.com/css?family=Roboto:400,100,300,500,700,900&subset=latin,latin-ext" rel="stylesheet" />
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>

</body>
<script>
    $("#igualdad").hide();
    $("#xmail").hide();
    $("#xpass").hide();
    $("#confirm").hide();
    $("#confirmar").hide();
    $("#divpass").show();
    $("#divpass1").show();
    $("#email").keyup(function () {
        caracteresCorreoValido($(this).val())
    });

    function caracteresCorreoValido(email) {
        var caract = new RegExp(/^(([^<>()\[\]\\.,;:\s@@"]+(\.[^<>()\[\]\\.,;:\s@@"]+)*)|(".+"))@@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/);
 /*       debugger;*/
        if (!caract.test(email)) {
            $("#xmail").show();

            return false;
        } else {
            $("#xmail").hide();
            return true;
        }
    }


    function atras() {
        window.location.href = '/Login/Login'
    }

    $("#pass").keyup(function () {
        var pass = $("#pass").val();
        var pass1 = $("#pass1").val();
        if (pass != pass1) {
            $("#igualdad").show();
        } else {
            $("#igualdad").hide();
        }
        validarContraseña(pass);
    });

    function validarContraseña(pass) {
        var caract = new RegExp(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@@$!%*?&])[A-Za-z\d@@$!%*?&]{8,}$/);
/*        debugger;*/
        if (caract.test(pass)) {
            $("#xpass").hide();
            return true;
        }
        else {
            $("#xpass").show();
            return false;
        }
    }
    $("#pass1").keyup(function () {
        var pass = $("#pass").val();
        var pass1 = $("#pass1").val();
        if (pass != pass1) {
            $("#igualdad").show();
        } else {
            $("#igualdad").hide();
        }
    });

    $(".input input").focus(function () {

        $(this).parent(".input").each(function () {
            $("label", this).css({
                "line-height": "18px",
                "font-size": "18px",
                "font-weight": "100",
                "top": "0px"
            })
            $(".spin", this).css({
                "width": "100%"
            })
        });
    }).blur(function () {
        $(".spin").css({
            "width": "0px"
        })
        if ($(this).val() == "") {
            $(this).parent(".input").each(function () {
                $("label", this).css({
                    "line-height": "60px",
                    "font-size": "24px",
                    "font-weight": "300",
                    "top": "10px"
                })
            });

        }
    });
    $(".alt-2").click(function () {
        if (!$(this).hasClass('material-button')) {
            $(".shape").css({
                "width": "100%",
                "height": "100%",
                "transform": "rotate(0deg)"
            })

            setTimeout(function () {
                $(".overbox").css({
                    "overflow": "initial"
                })
            }, 600)

            $(this).animate({
                "width": "140px",
                "height": "140px"
            }, 500, function () {
                $(".box").removeClass("back");

                $(this).removeClass('active')
            });

            $(".overbox .title").fadeOut(300);
            $(".overbox .input").fadeOut(300);
            $(".overbox .button").fadeOut(300);

            $(".alt-2").addClass('material-buton');
        }

    })

    $(".material-button").click(function () {

        if ($(this).hasClass('material-button')) {
            setTimeout(function () {
                $(".overbox").css({
                    "overflow": "hidden"
                })
                $(".box").addClass("back");
            }, 200)
            $(this).addClass('active').animate({
                "width": "700px",
                "height": "700px"
            });

            setTimeout(function () {
                $(".shape").css({
                    "width": "50%",
                    "height": "50%",
                    "transform": "rotate(45deg)"
                })

                $(".overbox .title").fadeIn(300);
                $(".overbox .input").fadeIn(300);
                $(".overbox .button").fadeIn(300);
            }, 700)

            $(this).removeClass('material-button');

        }

        if ($(".alt-2").hasClass('material-buton')) {
            $(".alt-2").removeClass('material-buton');
            $(".alt-2").addClass('material-button');
        }

    });

    $("#crearCuenta").click(function () {
        //Valido todos los datos
        
        validarMail();

    });
    function validarMail() {
        if ($("#pass").val() == $("#pass1").val()) {
            if (caracteresCorreoValido($("#email").val())) {
                if (validarContraseña($("#pass").val())) {
                $.ajax({
                    type: 'Get',
                    url: '/Api/Cuenta/ValidarMail?email=' + $("#email").val(),
                    success: function (result) {
                        if (result == 1) {
                            altaCuenta();
                        } else {
                            alert("El mail ingresado ya se encuentra registrado en el sistema")
                        }
                    }
                });
                }else alert ("Debe ingresar una contraseña válida")
            }
            else {
                alert("El formato de correo electrónico ingresado es incorrecto")
            }
        } else {
            //alert("Las contraseñas no coinciden")
        }

    }
    var codigo;
    function altaCuenta() {
        $.ajax({
            type: 'Get',
            url: '/Api/Cuenta/altaCuenta?email=' + $("#email").val() + '&password=' + $("#pass").val(),
            async: false,
            success: function (result) {
                codigo = result;
                $("#crearCuenta").hide();
                $("#divpass").hide();
                $("#divpass1").hide();
                alert("Se le envio un codigo a su mail");
                $("#confirm").show();
                $("#confirmar").show();
            }
        });
    }
    $("#confirmar").click(function () {
        if ($("#codigo").val() == codigo) {
            window.location.href = "/Cuenta/confirmaCuenta?email="+$("#email").val();
        }
        else {
            alert("El codigo no coincide");
        }
    });

   


</script>